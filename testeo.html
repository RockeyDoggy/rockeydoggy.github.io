<!DOCTYPE html>
<html>
<head>
    <title>Exemplo de Resgates no Chat da Twitch</title>
</head>
<body>
    <div id="redeemedRewards"></div>

    <script>
        // Dados da sua aplicação na Twitch
        const clientId = 'aeokv71t4icy8xlltwctqyncyge315';
        const clientSecret = 'pjcve9di1ghop9juwhtin4r8zkxjxk';
        const channelId = '40996260'; // Você pode usar a API para obter o ID do canal a partir do nome

        // Função para obter um token de acesso
        async function getAccessToken() {
            const response = await fetch(`https://id.twitch.tv/oauth2/token?client_id=${clientId}&client_secret=${clientSecret}&grant_type=client_credentials`, {
                method: 'POST'
            });
            const data = await response.json();
            return data.access_token;
        }

        // Função para obter mensagens de resgate no chat
        async function getRedeemedMessages() {
            const accessToken = await getAccessToken();
            const response = await fetch(`https://api.twitch.tv/helix/chat/messages?broadcaster_id=${channelId}`, {
                headers: {
                    'Client-ID': clientId,
                    'Authorization': `Bearer ${accessToken}`
                }
            });
            const data = await response.json();

            // Filtrar mensagens de resgate
            const redeemedMessages = data.data.filter(message => message.message_text.startsWith('!redeem'));

            // Obter informações básicas dos usuários que resgataram
            const redeemedUsers = [];
            for (const message of redeemedMessages) {
                redeemedUsers.push(message.user_id);
            }
            const uniqueUserIds = [...new Set(redeemedUsers)]; // Remover IDs duplicados

            // Exibir informações de resgate na página
            const redeemedRewardsDiv = document.getElementById("redeemedRewards");
            redeemedRewardsDiv.innerHTML = JSON.stringify(uniqueUserIds, null, 2);
        }

        // Chamar a função para obter resgates ao carregar a página
        getRedeemedMessages();
    </script>
</body>
</html>




